// Code generated by Microsoft (R) AutoRest Code Generator (autorest: 3.0.6306, generator: {generator})
// Changes may cause incorrect behavior and will be lost if the code is regenerated.

namespace Microsoft.Graph.Beta.PowerShell.Models.TeamsInternal
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using static Microsoft.Graph.Beta.PowerShell.Runtime.Extensions;

    /// <summary>
    /// Teams internal model for enumerated scope sensitivity labels in preapproval policies.
    /// </summary>
    internal class MGTeamsInternalEnumeratedScopeSensitivityLabels : MGTeamsInternalScopeSensitivityLabels
    {
        /// <summary>
        /// The Sensitivity labels.
        /// </summary>
        internal IEnumerable<string> SensitivityLabels { get; private set; }

        /// <summary>
        /// Deserializes a <see cref="Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonNode"/> into an instance of MGTeamsInternalEnumeratedScopeSensitivityLabels.
        /// </summary>
        /// <param name="node">a <see cref="Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonNode" /> to deserialize from.</param>
        /// <returns>an instance of MGTeamsInternalEnumeratedScopeSensitivityLabels.</returns>
        internal static new MGTeamsInternalEnumeratedScopeSensitivityLabels FromJson(Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonObject json)
        {
            return new MGTeamsInternalEnumeratedScopeSensitivityLabels(json);
        }

        /// <summary>
        /// Initializes a new instance of the <see cref="MGTeamsInternalEnumeratedPreApprovedPermissions"/> class.
        /// </summary>
        internal MGTeamsInternalEnumeratedScopeSensitivityLabels(Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonObject json)
            :base(json)
        {
            IEnumerable<string> sensitivityLabels = If(json.PropertyT<Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonArray>("sensitivityLabels"), out var jsonSensitivityLabels)
                ? jsonSensitivityLabels.Select(j => (string)j).ToArray()
                : Array.Empty<string>();

            this.SetProperties(sensitivityLabels);
        }

        /// <summary>
        /// Initializes a new instance of the <see cref="MGTeamsInternalEnumeratedPreApprovedPermissions"/> class.
        /// </summary>
        internal MGTeamsInternalEnumeratedScopeSensitivityLabels(IEnumerable<string> sensitivityLabels) : base(labelKind: "enumerated", type: "#microsoft.graph.enumeratedScopeSensitivityLabels")
        {
            this.SetProperties(sensitivityLabels);
        }

        /// <summary>
        /// Initialize properties of this object.
        /// </summary>
        private void SetProperties(IEnumerable<string> sensitivityLabels)
        {
            this.SensitivityLabels = sensitivityLabels;
        }

        /// <summary>
        /// Serialize this instance to a JsonNode.
        /// </summary>
        /// <returns>Json Node.</returns>
        internal override Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonNode ToJson()
        {
            Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonObject jsonObject =
                (Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonObject)base.ToJson();

            if (this.SensitivityLabels != null)
            {
                var sensitivityLabelsJson = new Microsoft.Graph.Beta.PowerShell.Runtime.Json.XNodeArray();
                foreach (var singleSensitivityLabel in this.SensitivityLabels)
                {
                    if (singleSensitivityLabel != null)
                    {
                        sensitivityLabelsJson.Add(new Microsoft.Graph.Beta.PowerShell.Runtime.Json.JsonString(singleSensitivityLabel));
                    }
                }

                jsonObject.Add("sensitivityLabels", sensitivityLabelsJson);
            }

            return jsonObject;
        }
    }
}